export interface TestResult {
  date: string;
  extraversion: number;
  neuroticism: number;
  temperament: string;
  timestamp: number;
}

export const eysenckQuestions = [
  // Экстраверсия (E) - нечетные вопросы
  { text: 'Часто ли вы испытываете тягу к новым впечатлениям, к тому, чтобы отвлечься, испытать сильные ощущения?', scale: 'E', answer: 'yes' },
  { text: 'Часто ли вы чувствуете, что нуждаетесь в друзьях, которые могут вас понять, ободрить или посочувствовать?', scale: 'N', answer: 'yes' },
  { text: 'Считаете ли вы себя беззаботным человеком?', scale: 'E', answer: 'yes' },
  { text: 'Очень ли трудно вам отказаться от своих намерений?', scale: 'L', answer: 'yes' },
  { text: 'Обдумываете ли вы свои дела не спеша и предпочитаете ли подождать, прежде чем действовать?', scale: 'E', answer: 'no' },
  { text: 'Всегда ли вы сдерживаете свои обещания, даже если это вам невыгодно?', scale: 'L', answer: 'yes' },
  { text: 'Часто ли у вас бывают спады и подъемы настроения?', scale: 'N', answer: 'yes' },
  { text: 'Действуете ли вы обычно и говорите быстро, не затрачивая много времени на обдумывание?', scale: 'E', answer: 'yes' },
  { text: 'Возникало ли у вас когда-нибудь чувство, что вы несчастны, хотя никакой серьезной причины для этого не было?', scale: 'N', answer: 'yes' },
  { text: 'Верно ли, что на спор вы способны решиться на всё?', scale: 'E', answer: 'yes' },
  { text: 'Смущаетесь ли вы, когда хотите познакомиться с человеком противоположного пола?', scale: 'N', answer: 'yes' },
  { text: 'Бывает ли когда-нибудь, что, разозлившись, вы выходите из себя?', scale: 'L', answer: 'yes' },
  { text: 'Часто ли бывает, что вы действуете необдуманно, под влиянием момента?', scale: 'E', answer: 'yes' },
  { text: 'Часто ли вас беспокоят мысли о том, что вам не следовало что-либо делать или говорить?', scale: 'N', answer: 'yes' },
  { text: 'Предпочитаете ли вы чтение книг встречам с людьми?', scale: 'E', answer: 'no' },
  { text: 'Верно ли, что вас легко задеть?', scale: 'N', answer: 'yes' },
  { text: 'Любите ли вы часто бывать в компании?', scale: 'E', answer: 'yes' },
  { text: 'Бывают ли у вас такие мысли, которыми вам не хотелось бы делиться с другими людьми?', scale: 'L', answer: 'yes' },
  { text: 'Верно ли, что иногда вы настолько полны энергии, что всё горит в руках, а иногда чувствуете усталость?', scale: 'N', answer: 'yes' },
  { text: 'Стараетесь ли вы ограничить круг своих знакомых небольшим числом самых близких друзей?', scale: 'E', answer: 'no' },
  { text: 'Много ли вы мечтаете?', scale: 'N', answer: 'yes' },
  { text: 'Когда на вас кричат, отвечаете ли вы тем же?', scale: 'E', answer: 'yes' },
  { text: 'Часто ли вас беспокоит чувство вины?', scale: 'N', answer: 'yes' },
  { text: 'Часто ли у вас появляется чувство, что вы в чем-то виноваты?', scale: 'N', answer: 'yes' },
  { text: 'Способны ли вы иногда дать волю своим чувствам и беззаботно развлекаться с весёлой компанией?', scale: 'E', answer: 'yes' },
  { text: 'Можно ли сказать, что нервы у вас часто бывают натянуты до предела?', scale: 'N', answer: 'yes' },
  { text: 'Слывете ли вы за человека живого и весёлого?', scale: 'E', answer: 'yes' },
  { text: 'После того как дело сделано, часто ли вы мысленно возвращаетесь к нему и думаете, что могли бы сделать лучше?', scale: 'N', answer: 'yes' },
  { text: 'Чувствуете ли вы себя неспокойно, находясь в большой компании?', scale: 'E', answer: 'no' },
  { text: 'Бывает ли, что вы передаёте слухи?', scale: 'L', answer: 'yes' },
  { text: 'Бывает ли, что вам не спится из-за того, что в голову лезут разные мысли?', scale: 'N', answer: 'yes' },
  { text: 'Что вы предпочитаете: если хотите что-то узнать, найти в книге или спросить у людей?', scale: 'E', answer: 'people' },
  { text: 'Бывают ли у вас сердцебиения?', scale: 'N', answer: 'yes' },
  { text: 'Нравится ли вам работа, требующая сосредоточенности?', scale: 'E', answer: 'no' },
  { text: 'Бывают ли у вас приступы дрожи?', scale: 'N', answer: 'yes' },
  { text: 'Всегда ли вы говорите только правду?', scale: 'L', answer: 'yes' },
  { text: 'Бывает ли вам неприятно находиться в компании, где всё время подшучивают друг над другом?', scale: 'E', answer: 'no' },
  { text: 'Раздражительны ли вы?', scale: 'N', answer: 'yes' },
  { text: 'Нравится ли вам работа, требующая быстроты действий?', scale: 'E', answer: 'yes' },
  { text: 'Верно ли, что вам часто не дают покоя мысли о разных неприятностях и ужасах, которые могли бы произойти, хотя всё кончилось благополучно?', scale: 'N', answer: 'yes' },
  { text: 'Верно ли, что вы неторопливы в движениях и несколько медлительны?', scale: 'E', answer: 'no' },
  { text: 'Опаздывали ли вы когда-нибудь на работу или на встречу с кем-либо?', scale: 'L', answer: 'yes' },
  { text: 'Часто ли вам снятся кошмары?', scale: 'N', answer: 'yes' },
  { text: 'Верно ли, что вы так любите поговорить, что не упускаете любого удобного случая побеседовать с новым человеком?', scale: 'E', answer: 'yes' },
  { text: 'Беспокоят ли вас какие-нибудь боли?', scale: 'N', answer: 'yes' },
  { text: 'Огорчились бы вы, если бы долго не могли видеться со своими друзьями?', scale: 'E', answer: 'yes' },
  { text: 'Можете ли вы назвать себя нервным человеком?', scale: 'N', answer: 'yes' },
  { text: 'Есть ли среди ваших знакомых такие, которые вам явно не нравятся?', scale: 'L', answer: 'yes' },
  { text: 'Могли бы вы сказать, что вы уверенный в себе человек?', scale: 'E', answer: 'yes' },
  { text: 'Легко ли вас задевает критика ваших недостатков или вашей работы?', scale: 'N', answer: 'yes' },
  { text: 'Трудно ли вам получить настоящее удовольствие от мероприятий, в которых участвует много народа?', scale: 'E', answer: 'no' },
  { text: 'Беспокоит ли вас чувство, что вы чем-то хуже других?', scale: 'N', answer: 'yes' },
  { text: 'Сумели бы вы внести оживление в скучную компанию?', scale: 'E', answer: 'yes' },
  { text: 'Бывает ли, что вы говорите о вещах, в которых совсем не разбираетесь?', scale: 'L', answer: 'yes' },
  { text: 'Беспокоитесь ли вы о своём здоровье?', scale: 'N', answer: 'yes' },
  { text: 'Любите ли вы подшучивать над другими?', scale: 'E', answer: 'yes' },
  { text: 'Страдаете ли вы бессонницей?', scale: 'N', answer: 'yes' }
];

export const getTemperamentType = (extraversion: number, neuroticism: number): string => {
  if (extraversion >= 12 && neuroticism < 12) return 'Сангвиник';
  if (extraversion >= 12 && neuroticism >= 12) return 'Холерик';
  if (extraversion < 12 && neuroticism >= 12) return 'Меланхолик';
  return 'Флегматик';
};

export const getTemperamentDescription = (type: string) => {
  const descriptions: Record<string, any> = {
    'Сангвиник': {
      title: 'Сангвиник',
      subtitle: 'Стабильный экстраверт',
      color: 'text-yellow-600',
      bgColor: 'bg-yellow-50',
      borderColor: 'border-yellow-200',
      icon: 'Sun',
      chartColor: '#eab308',
      traits: [
        'Общительный, открытый, жизнерадостный',
        'Легко приспосабливается к новым условиям',
        'Быстро сходится с людьми',
        'Чувства возникают легко и быстро сменяют друг друга',
        'Эмоционально устойчив',
        'Продуктивный деятель, когда работа интересна'
      ],
      weaknesses: [
        'Может быть поверхностным в чувствах',
        'Склонен к непостоянству',
        'Трудно выполнять однообразную работу'
      ],
      recommendations: 'Развивайте глубину в отношениях и устойчивость в делах. Учитесь доводить начатое до конца. Контролируйте склонность к поверхностности.'
    },
    'Холерик': {
      title: 'Холерик',
      subtitle: 'Нестабильный экстраверт',
      color: 'text-red-600',
      bgColor: 'bg-red-50',
      borderColor: 'border-red-200',
      icon: 'Flame',
      chartColor: '#dc2626',
      traits: [
        'Быстрый, порывистый, энергичный',
        'Способен отдаваться делу со страстью',
        'Склонен к резким сменам настроения',
        'Эмоциональные вспышки',
        'Инициативен и настойчив',
        'Лидерские качества'
      ],
      weaknesses: [
        'Несдержан, вспыльчив',
        'Нетерпелив',
        'Резок в общении',
        'Склонен к конфликтам'
      ],
      recommendations: 'Работайте над самоконтролем и эмоциональной регуляцией. Развивайте терпение и сдержанность. Учитесь слушать других и учитывать их мнение.'
    },
    'Флегматик': {
      title: 'Флегматик',
      subtitle: 'Стабильный интроверт',
      color: 'text-blue-600',
      bgColor: 'bg-blue-50',
      borderColor: 'border-blue-200',
      icon: 'Mountain',
      chartColor: '#2563eb',
      traits: [
        'Спокойный, уравновешенный, медлительный',
        'Трудно переключается с одного на другое',
        'Эмоции устойчивы, но внешне слабо выражены',
        'Надёжен и постоянен',
        'Терпелив и выдержан',
        'Доводит начатое до конца'
      ],
      weaknesses: [
        'Медлителен',
        'Трудно приспосабливается к новому',
        'Инертен',
        'Безразличен к окружающим'
      ],
      recommendations: 'Развивайте гибкость и способность к адаптации. Работайте над скоростью реакций. Старайтесь проявлять больше эмоций в общении.'
    },
    'Меланхолик': {
      title: 'Меланхолик',
      subtitle: 'Нестабильный интроверт',
      color: 'text-purple-600',
      bgColor: 'bg-purple-50',
      borderColor: 'border-purple-200',
      icon: 'CloudRain',
      chartColor: '#9333ea',
      traits: [
        'Глубокие и устойчивые переживания',
        'Чувствительный и впечатлительный',
        'Сдержан и застенчив',
        'Склонен к самоанализу',
        'Тонко чувствует искусство',
        'Ответственный и обязательный'
      ],
      weaknesses: [
        'Болезненно реагирует на критику',
        'Склонен к тревожности',
        'Замкнут',
        'Неуверен в себе'
      ],
      recommendations: 'Работайте над уверенностью в себе. Развивайте стрессоустойчивость. Учитесь воспринимать критику конструктивно. Расширяйте круг общения.'
    }
  };

  return descriptions[type];
};

export const calculateScores = (answers: (string | null)[]) => {
  let extraversion = 0;
  let neuroticism = 0;
  let lie = 0;

  eysenckQuestions.forEach((question, index) => {
    const answer = answers[index];
    if (!answer) return;

    const isPositive = question.answer === 'yes' 
      ? answer === 'yes' 
      : question.answer === 'no' 
        ? answer === 'no' 
        : answer === 'people';

    if (isPositive) {
      if (question.scale === 'E') extraversion++;
      if (question.scale === 'N') neuroticism++;
      if (question.scale === 'L') lie++;
    }
  });

  return { extraversion, neuroticism, lie };
};
